<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Input · PhyNEST.jl</title><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.png" alt="PhyNEST.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">PhyNEST.jl</a></span></div><form class="docs-search" action="../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../">PhyNEST.jl</a></li><li><span class="tocitem">Manual</span><ul><li><a class="tocitem" href="../installation/">Installation</a></li><li class="is-active"><a class="tocitem" href>Input</a><ul class="internal"><li><a class="tocitem" href="#Parsing-DNA-alignment-data"><span>Parsing DNA alignment data</span></a></li><li><a class="tocitem" href="#Reading-.ckp-file"><span>Reading <code>.ckp</code> file</span></a></li><li><a class="tocitem" href="#Exporting-as-.csv-file"><span>Exporting as <code>.csv</code> file</span></a></li></ul></li><li><a class="tocitem" href="../networkest/">Network estimation</a></li><li><a class="tocitem" href="../quartet/">Quartet</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Manual</a></li><li class="is-active"><a href>Input</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Input</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/sungsik-kong/PhyNEST.jl/blob/main/docs/src/manual/input.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Input"><a class="docs-heading-anchor" href="#Input">Input</a><a id="Input-1"></a><a class="docs-heading-anchor-permalink" href="#Input" title="Permalink"></a></h1><p>Current version of PhyNE takes a relaxed, sequential, PHYLIP formatted DNA alignment file. Extensions can be either <code>.phy</code> or <code>.txt</code>. For more information on PHYLIP, see <a href="https://en.wikipedia.org/wiki/PHYLIP">here</a>. After the PHYLIP file has been parsed, PhyNE creates a checkpoint file with the extension <code>.ckp</code>, which can be called later to prevent repetition of parsing the same data and save time. Moreover, the observed site pattern frequencies of every quartet from the alignment can be exported into a <code>.csv</code> file, for a user to explore for other purposes (e.g., manually computation of Patterson&#39;s D-statistic etc.). The following sections explain above procedures in detail.</p><h2 id="Parsing-DNA-alignment-data"><a class="docs-heading-anchor" href="#Parsing-DNA-alignment-data">Parsing DNA alignment data</a><a id="Parsing-DNA-alignment-data-1"></a><a class="docs-heading-anchor-permalink" href="#Parsing-DNA-alignment-data" title="Permalink"></a></h2><p>A sample DNA alignment file called <code>n5h1_5k.txt</code> is given in the <code>example</code> folder of the package PhyNE (or can be downloaded <a href="https://github.com/sungsik-kong/PhyNE.jl/blob/main/example/n5h1_5k.txt">here</a>). This alignment is 750,000 base pairs (bp) long and contains five sequences, named as  <code>[1, 2, 3, 4, 5]</code>. The alignment is generated using <em>ms</em> and <em>seq-gen</em>. The true relationship of the five taxa is written in the extended Newick format as (branch lengths omittted): </p><p><code>(5,(4,((3,(2)#H6:::0.6),(1,#H6:::0.4))));</code>.</p><p>We begin with loading the package PhyNE in Julia.</p><pre><code class="language-julia hljs">using PhyNEST</code></pre><p>Assuming that you are working in the directory that contains the alignment file, the alignment file can be read using the function <code>readPhylipFile!(inputfile)</code>. Since the variable <code>inputfile</code> is expected to be a string, the file name should be in the quotation marks. The path of the file can be set as shown below or simply the name of the alignment file can be specified (e.g., <code>readPhylipFile!(&quot;n5h1_5k.txt&quot;)</code>). A checkpoint file with an extension <code>.ckp</code> is automatically created in the working directory upon completion of parsing the alignment. When the boolean option <code>showProgress</code> is set as <code>true</code>, PhyNE will show the progress bar during the data parsing process. Here, we set it as false for brevity.</p><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; datapath = joinpath(dirname(pathof(PhyNEST)), &quot;..&quot;,&quot;example&quot;,&quot;n5h1_5k.txt&quot;);</code><code class="nohighlight hljs ansi" style="display:block;"></code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; phydata = readPhylipFile!(datapath, showProgress=false)</code><code class="nohighlight hljs ansi" style="display:block;">Summary: Phylip File
Parsing the file [/home/runner/work/PhyNEST.jl/PhyNEST.jl/src/../example/n5h1_5k.txt] took [72.776] seconds.
Number of taxa: 5
Species names: [&quot;5&quot;, &quot;4&quot;, &quot;3&quot;, &quot;1&quot;, &quot;2&quot;]
Sequence length (b.p): 2500000
Site patterns frequencies for [120] quartets computed and stored.</code></pre><h2 id="Reading-.ckp-file"><a class="docs-heading-anchor" href="#Reading-.ckp-file">Reading <code>.ckp</code> file</a><a id="Reading-.ckp-file-1"></a><a class="docs-heading-anchor-permalink" href="#Reading-.ckp-file" title="Permalink"></a></h2><p>Every time a sequence alignment is parsed, PhyNE creates a checkpoint file with the extension <code>.ckp</code>. Note the <code>.ckp</code> file will have the same name as the alignment file. In case multiple network analyses using the same data is planned, a user can bypass the (potentially time-consuming) data parsing process by using the function <code>readCheckPoint(ckpfile)</code> instead of the function <code>readPhylipFile!(inputfile)</code>. </p><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; ckppath = joinpath(dirname(pathof(PhyNEST)), &quot;..&quot;,&quot;example&quot;,&quot;n5h1_5k.txt.ckp&quot;);</code><code class="nohighlight hljs ansi" style="display:block;"></code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; ckpdata = readCheckPoint(ckppath)</code><code class="nohighlight hljs ansi" style="display:block;">Summary: Phylip File
Parsing the file [/home/runner/work/PhyNEST.jl/PhyNEST.jl/src/../example/n5h1_5k.txt] took [72.776] seconds.
Number of taxa: 5
Species names: [&quot;5&quot;, &quot;4&quot;, &quot;3&quot;, &quot;1&quot;, &quot;2&quot;]
Sequence length (b.p): 2500000
Site patterns frequencies for [120] quartets computed and stored.</code></pre><h2 id="Exporting-as-.csv-file"><a class="docs-heading-anchor" href="#Exporting-as-.csv-file">Exporting as <code>.csv</code> file</a><a id="Exporting-as-.csv-file-1"></a><a class="docs-heading-anchor-permalink" href="#Exporting-as-.csv-file" title="Permalink"></a></h2><p>The observed quartet site pattern frequencies from the data can be exported as a <code>.csv</code> formatted file. This can be done when parsing the alignment using the function <code>readPhylipFile!</code> by setting the option <code>writecsv=true</code>. It will create a <code>.csv</code> file in the working directory with the filename <code>sitePatternCounts_$inputfile.csv</code>. If a user would like to save the <code>.csv</code> file in a different name, the file name can be specified in the option <code>csvname</code>. In the below example, we set the filename as &quot;tutorial_n5h1&quot; for the <code>.csv</code> file. The <code>.csv</code> file can be visualized using function <code>readCSVFile(csvfile)</code>. </p><p>If a user forgot to set <code>writecsv=true</code>, the function <code>writeSitePatternCounts</code> can be used to export. See <a href="https://sungsik-kong.github.io/PhyNE.jl/dev/#PhyNE.writeSitePatternCounts">here</a> for more information.</p><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; phydata = readPhylipFile!(datapath, showProgress=false,
                               writecsv=true, csvname=&quot;tutorial_n5h1&quot;)</code><code class="nohighlight hljs ansi" style="display:block;">A [.csv] file is saved as tutorial_n5h1.csv in the current working directory.
Summary: Phylip File
Parsing the file [/home/runner/work/PhyNEST.jl/PhyNEST.jl/src/../example/n5h1_5k.txt] took [74.864] seconds.
Number of taxa: 5
Species names: [&quot;5&quot;, &quot;4&quot;, &quot;3&quot;, &quot;1&quot;, &quot;2&quot;]
Sequence length (b.p): 2500000
Site patterns frequencies for [120] quartets computed and stored.</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; csvpath = joinpath(dirname(pathof(PhyNEST)), &quot;..&quot;,&quot;example&quot;,&quot;tutorial_n5h1.csv&quot;);</code><code class="nohighlight hljs ansi" style="display:block;"></code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; csvdf = readCSVFile(csvpath)</code><code class="nohighlight hljs ansi" style="display:block;">120×19 DataFrame
 Row │ i      j      k      l      AAAA     AAAB   AABA   AABB   AABC   ABAA   ⋯
     │ Int64  Int64  Int64  Int64  Int64    Int64  Int64  Int64  Int64  Int64  ⋯
─────┼──────────────────────────────────────────────────────────────────────────
   1 │     5      4      3      1  2383173  14271  14456   7456    122  21556  ⋯
   2 │     5      4      3      2  2385791  11653  11707  10219    108  21669
   3 │     5      4      1      2  2385904  11725  11594  10140    115  21635
   4 │     5      3      1      2  2395943   8786  11517   3104     57  11596
   5 │     4      3      1      2  2431508   8889  11644   3109     55  11752  ⋯
   6 │     5      4      1      3  2383173  14456  14271   7456    122  21556
   7 │     5      3      4      1  2383173  14271  21556    318     89  14456
   8 │     5      3      1      4  2383173  21556  14271    318     89  14456
  ⋮  │   ⋮      ⋮      ⋮      ⋮       ⋮       ⋮      ⋮      ⋮      ⋮      ⋮    ⋱
 114 │     1      2      3      4  2431508  29087  11752   3109    122   8889  ⋯
 115 │     2      4      3      1  2431508  11644  11752    323     41  29087
 116 │     2      4      1      3  2431508  11752  11644    323     41  29087
 117 │     2      3      4      1  2431508  11644  29087   3205    134  11752
 118 │     2      3      1      4  2431508  29087  11644   3205    134  11752  ⋯
 119 │     2      1      4      3  2431508  11752  29087   3109    122  11644
 120 │     2      1      3      4  2431508  29087  11752   3109    122  11644
                                                  9 columns and 105 rows omitted</code></pre></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../installation/">« Installation</a><a class="docs-footer-nextpage" href="../networkest/">Network estimation »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.23 on <span class="colophon-date" title="Friday 4 November 2022 23:49">Friday 4 November 2022</span>. Using Julia version 1.8.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
