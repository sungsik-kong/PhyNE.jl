<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Quartet · PhyNEST.jl</title><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.png" alt="PhyNEST.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">PhyNEST.jl</a></span></div><form class="docs-search" action="../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../">PhyNEST.jl</a></li><li><span class="tocitem">Manual</span><ul><li><a class="tocitem" href="../installation/">Installation</a></li><li><a class="tocitem" href="../input/">Input</a></li><li><a class="tocitem" href="../networkest/">Network estimation</a></li><li class="is-active"><a class="tocitem" href>Quartet</a><ul class="internal"><li><a class="tocitem" href="#Reading-a-network"><span>Reading a network</span></a></li><li><a class="tocitem" href="#Extract-quartet(s)"><span>Extract quartet(s)</span></a></li><li><a class="tocitem" href="#True-site-pattern-probabilities-for-a-quartet"><span>True site pattern probabilities for a quartet</span></a></li><li><a class="tocitem" href="#Simulate-true-site-pattern-frequencies"><span>Simulate true site pattern frequencies</span></a></li><li><a class="tocitem" href="#Method-of-moment-estimator-of-branch-lengths"><span>Method-of-moment estimator of branch lengths</span></a></li><li><a class="tocitem" href="#Estimating-theta"><span>Estimating theta</span></a></li></ul></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Manual</a></li><li class="is-active"><a href>Quartet</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Quartet</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/sungsik-kong/PhyNEST.jl/blob/main/docs/src/manual/quartet.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Quartet"><a class="docs-heading-anchor" href="#Quartet">Quartet</a><a id="Quartet-1"></a><a class="docs-heading-anchor-permalink" href="#Quartet" title="Permalink"></a></h1><h2 id="Reading-a-network"><a class="docs-heading-anchor" href="#Reading-a-network">Reading a network</a><a id="Reading-a-network-1"></a><a class="docs-heading-anchor-permalink" href="#Reading-a-network" title="Permalink"></a></h2><p>An extended Newick string can be read by the function <code>readTopology</code> from <code>PhyloNetworks</code>. See <a href="https://doi.org/10.1186/1471-2105-9-532">Cardona et al.,(2008)</a> to see the first description of the extended Newick formatted network. Here we use a five tip network:</p><p><code>(5,(4,((3,(2)#H6:::0.6),(1,#H6:::0.4))));</code>.</p><p>PhyNEST uses the same the extended Newick format as in <code>PhyloNetworks</code>. Branch lengths can be specified using colon (<code>:</code>) as in a regular Newick string. For reticulation nodes, relevant information are specified in the order of &#39;:length:bootstrap:gamma&#39;. PhyNEST does <em>not</em> require branch lengths to be specified, however, if gamma is specified, it will be set as 0.5 .</p><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; using PhyNEST</code><code class="nohighlight hljs ansi" style="display:block;"></code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; network = readTopology(&quot;(5,(4,((3,(2)#H6:::0.6),(1,#H6:::0.4))));&quot;)</code><code class="nohighlight hljs ansi" style="display:block;">PhyloNetworks.HybridNetwork, Rooted Network
11 edges
11 nodes: 5 tips, 1 hybrid nodes, 5 internal tree nodes.
tip labels: 5, 4, 3, 2, ...
(5,(4,((3,(2)#H6:::0.6),(1,#H6:::0.4))));</code></pre><h2 id="Extract-quartet(s)"><a class="docs-heading-anchor" href="#Extract-quartet(s)">Extract quartet(s)</a><a id="Extract-quartet(s)-1"></a><a class="docs-heading-anchor-permalink" href="#Extract-quartet(s)" title="Permalink"></a></h2><p>PhyNE can extract quartets extracted from a tree or a network using the function <code>extractQuartets</code>.  </p><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; printQuartets(network)</code><code class="nohighlight hljs ansi" style="display:block;">Summary of the quartets extracted from the topoology:
(5,(4,((3,(2)#H6:::0.6),(1,#H6:::0.4))));

Number of parental trees: 2
Total number of quartets extracted: 10

Hereafter, we replace each species name into the following integers.
	&quot;5&quot; =&gt; 1
	&quot;4&quot; =&gt; 2
	&quot;3&quot; =&gt; 3
	&quot;2&quot; =&gt; 4
	&quot;1&quot; =&gt; 6

Legend to the quartet types:
	Type 0: ((1,2),(3,4));
	Type 1: (1,((2,3),4));
	Type 2: ((1,(2,3)),4);
	Type 3: (1,(2,(3,4))); 
	Type 4: (((1,2),3),4);

Gamma for parental tree 1: 0.6
5×5 DataFrame
 Row │ Count  Quartet       MRCA                      Taus          Type
     │ Int64  Array         Array                     Array         Int64
─────┼────────────────────────────────────────────────────────────────────
   1 │     1  [1, 2, 3, 4]  [-2, -2, -2, -3, -3, -5]  [-5, -3, -2]      3
   2 │     2  [1, 2, 3, 6]  [-2, -2, -2, -3, -3, -4]  [-4, -3, -2]      3
   3 │     3  [1, 2, 4, 6]  [-2, -2, -2, -3, -3, -4]  [-4, -3, -2]      3
   4 │     4  [1, 3, 4, 6]  [-2, -2, -2, -5, -4, -4]  [-5, -4, -2]      1
   5 │     5  [2, 3, 4, 6]  [-3, -3, -3, -5, -4, -4]  [-5, -4, -3]      1

Gamma for parental tree 2: 0.4
5×5 DataFrame
 Row │ Count  Quartet       MRCA                      Taus          Type
     │ Int64  Array         Array                     Array         Int64
─────┼────────────────────────────────────────────────────────────────────
   1 │     1  [1, 2, 3, 4]  [-2, -2, -2, -3, -3, -4]  [-4, -3, -2]      3
   2 │     2  [1, 2, 3, 6]  [-2, -2, -2, -3, -3, -4]  [-4, -3, -2]      3
   3 │     3  [1, 2, 4, 6]  [-2, -2, -2, -3, -3, -7]  [-7, -3, -2]      3
   4 │     4  [1, 3, 4, 6]  [-2, -2, -2, -4, -4, -7]  [-7, -4, -2]      3
   5 │     5  [2, 3, 4, 6]  [-3, -3, -3, -4, -4, -7]  [-7, -4, -3]      3</code></pre><h2 id="True-site-pattern-probabilities-for-a-quartet"><a class="docs-heading-anchor" href="#True-site-pattern-probabilities-for-a-quartet">True site pattern probabilities for a quartet</a><a id="True-site-pattern-probabilities-for-a-quartet-1"></a><a class="docs-heading-anchor-permalink" href="#True-site-pattern-probabilities-for-a-quartet" title="Permalink"></a></h2><p>See <a href="https://www.sciencedirect.com/science/article/pii/S0022519315001095?via%3Dihub">Chifman and Kubatko (2015)</a> for more information.</p><h3 id="Symmetric-quartet"><a class="docs-heading-anchor" href="#Symmetric-quartet">Symmetric quartet</a><a id="Symmetric-quartet-1"></a><a class="docs-heading-anchor-permalink" href="#Symmetric-quartet" title="Permalink"></a></h3><p>True site pattern probabilities for the fifteen site pattern for a symmetric quartet under the JC69 model can be computed using the function <code>TrueSitePatternSymm</code>. We need to specify at least four parameters, three values of node ages, <span>$\tau$</span>, in the order of [MRCA of species 1 and 2, MRCA of species 3 and 4, root age] and population size parameter <span>$\theta$</span>. In the following block, we computed the probabilities for <span>$\tau_1=1.0$</span>, <span>$\tau_2=2.0$</span>, <span>$\tau_3=5.0$</span>, and <span>$\theta=0.0025$</span>. The 15 patterns appear in the order of [AAAA,AAAB,AABA,AABB,AABC,ABAA,ABAB,ABAC,ABBA,BAAA,ABBC,CABC,BACA,BCAA,ABCD]. </p><p>We assure that the computation is on the right track by multiplying the weight for each site pattern, and sum all of them together to get 1.0.</p><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; symqProb=TrueSitePatternSymm(1.0,2.0,5.0,0.0025)</code><code class="nohighlight hljs ansi" style="display:block;">15-element Vector{Float64}:
 0.23962355956839557
 0.00040183279774349406
 0.00040183279774349406
 0.0014085244500744824
 5.197947417551283e-6
 0.0006035346691620966
 2.0712667029507137e-6
 1.0216168918508912e-6
 2.0712667029507137e-6
 0.0006035346691620966
 1.0216168918508912e-6
 1.0216168918508912e-6
 1.0216168918508912e-6
 8.390874669438053e-6
 3.0490300551329126e-8</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; weights=[4,12,12,12,24,12,12,24,12,12,24,24,24,24,24]</code><code class="nohighlight hljs ansi" style="display:block;">15-element Vector{Int64}:
  4
 12
 12
 12
 24
 12
 12
 24
 12
 12
 24
 24
 24
 24
 24</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; sum(symqProb.*weights)</code><code class="nohighlight hljs ansi" style="display:block;">0.9999999999999996</code></pre><h3 id="Asymmetric-quartet"><a class="docs-heading-anchor" href="#Asymmetric-quartet">Asymmetric quartet</a><a id="Asymmetric-quartet-1"></a><a class="docs-heading-anchor-permalink" href="#Asymmetric-quartet" title="Permalink"></a></h3><p>PhyNEST also computes true site pattern probabilities for the asymmetric quartet under the JC69 model using the function <code>TrueSitePatternAsymm</code>. The asymmetric quartet that we consider here can be written as (4,(3,(2,1))); in a Newick format. Similar to the symmetric quartet case above, three speciation times should be specified in the order of [MRCA of (1,2), MRCA of (1,2,3), root age], plus <span>$\theta$</span>. </p><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; asymqProb=TrueSitePatternAsymm(1.0,2.0,5.0,0.0025)</code><code class="nohighlight hljs ansi" style="display:block;">15-element Vector{Float64}:
 0.23970140864994496
 0.00037588310389369446
 0.00037588310389369446
 0.0002293195152703372
 1.2232752423582682e-6
 0.0005775849753122952
 2.8069077819539365e-5
 9.975582584582903e-7
 2.8069077819539365e-5
 0.0017866620573686737
 3.011003732439706e-6
 9.975582584582903e-7
 3.011003732439706e-6
 6.429647968226454e-6
 2.6388794569464492e-8</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; weights=[4,12,12,12,24,12,12,24,12,12,24,24,24,24,24]</code><code class="nohighlight hljs ansi" style="display:block;">15-element Vector{Int64}:
  4
 12
 12
 12
 24
 12
 12
 24
 12
 12
 24
 24
 24
 24
 24</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; sum(symqProb.*weights)</code><code class="nohighlight hljs ansi" style="display:block;">0.9999999999999996</code></pre><h2 id="Simulate-true-site-pattern-frequencies"><a class="docs-heading-anchor" href="#Simulate-true-site-pattern-frequencies">Simulate true site pattern frequencies</a><a id="Simulate-true-site-pattern-frequencies-1"></a><a class="docs-heading-anchor-permalink" href="#Simulate-true-site-pattern-frequencies" title="Permalink"></a></h2><p>Function <code>simspcounts</code> generates the site-pattern frequencies for the symmetric and asymmetric quartets, modeled as a multinomial random variables assuming the observed sites are independent from each other. The length of sequence is 1000000 bp by default. Three speciation times for the quartet must be specified by the user. Theta and alpha are set as 0.0025 and 4/3, respectively, by default.</p><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; simSPsym=simspcounts(0,1.0,2.0,5.0,0.0025,4/3,1000000)</code><code class="nohighlight hljs ansi" style="display:block;">15-element Vector{Int64}:
 958198
   4802
   4895
  16853
    144
   7325
     19
     23
     24
   7436
     28
     23
     25
    203
      2</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; simSPasym=simspcounts(3,1.0,2.0,5.0,0.0025,4/3,1000000)</code><code class="nohighlight hljs ansi" style="display:block;">15-element Vector{Int64}:
 958972
   4504
   4497
   2816
     14
   6872
    325
     33
    337
  21318
     81
     23
     73
    134
      1</code></pre><h2 id="Method-of-moment-estimator-of-branch-lengths"><a class="docs-heading-anchor" href="#Method-of-moment-estimator-of-branch-lengths">Method-of-moment estimator of branch lengths</a><a id="Method-of-moment-estimator-of-branch-lengths-1"></a><a class="docs-heading-anchor-permalink" href="#Method-of-moment-estimator-of-branch-lengths" title="Permalink"></a></h2><p>function momentEstimat(type::Integer,spcounts::Array,theta::Float64)</p><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; momEstsym=momentEstimat(0,simSPsym,0.0025)</code><code class="nohighlight hljs ansi" style="display:block;">(1.013731132296133, 2.0557671256380785, 5.02805640847155)</code></pre><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; momEstasym=momentEstimat(3,simSPasym,0.0025)</code><code class="nohighlight hljs ansi" style="display:block;">(0.9957511554997523, 1.994911684547811, 4.973224006913598)</code></pre><h2 id="Estimating-theta"><a class="docs-heading-anchor" href="#Estimating-theta">Estimating theta</a><a id="Estimating-theta-1"></a><a class="docs-heading-anchor-permalink" href="#Estimating-theta" title="Permalink"></a></h2><p>function startTheta(q::Array{Nquartets, 1},net::HybridNetwork; lbound=0.00001::Float64,factor=2.0::Float64)</p><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; datapath = joinpath(dirname(pathof(PhyNEST)), &quot;..&quot;,&quot;example&quot;,&quot;n5h1_5k.txt&quot;);</code><code class="nohighlight hljs ansi" style="display:block;"></code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; phydata = readPhylipFile!(datapath, showProgress=false)</code><code class="nohighlight hljs ansi" style="display:block;">Summary: Phylip File
Parsing the file [/home/runner/work/PhyNEST.jl/PhyNEST.jl/src/../example/n5h1_5k.txt] took [62.403] seconds.
Number of taxa: 5
Species names: [&quot;5&quot;, &quot;4&quot;, &quot;3&quot;, &quot;1&quot;, &quot;2&quot;]
Sequence length (b.p): 2500000
Site patterns frequencies for [120] quartets computed and stored.</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; theta=startTheta(network,phydata)</code><code class="nohighlight hljs ansi" style="display:block;">0.002559999924257746</code></pre></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../networkest/">« Network estimation</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.23 on <span class="colophon-date" title="Friday 4 November 2022 23:56">Friday 4 November 2022</span>. Using Julia version 1.8.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
