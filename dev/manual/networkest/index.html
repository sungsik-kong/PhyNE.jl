<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Network estimation · PhyNEST.jl</title><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.png" alt="PhyNEST.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">PhyNEST.jl</a></span></div><form class="docs-search" action="../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../">PhyNEST.jl</a></li><li><span class="tocitem">Manual</span><ul><li><a class="tocitem" href="../installation/">Installation</a></li><li><a class="tocitem" href="../input/">Input</a></li><li class="is-active"><a class="tocitem" href>Network estimation</a><ul class="internal"><li><a class="tocitem" href="#Getting-ready-for-the-network-estimation"><span>Getting ready for the network estimation</span></a></li><li><a class="tocitem" href="#Hill-climbing"><span>Hill climbing</span></a></li><li><a class="tocitem" href="#Simulated-annealing"><span>Simulated annealing</span></a></li></ul></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Manual</a></li><li class="is-active"><a href>Network estimation</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Network estimation</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/sungsik-kong/PhyNEST.jl/blob/main/docs/src/manual/networkest.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Network-estimation"><a class="docs-heading-anchor" href="#Network-estimation">Network estimation</a><a id="Network-estimation-1"></a><a class="docs-heading-anchor-permalink" href="#Network-estimation" title="Permalink"></a></h1><h2 id="Getting-ready-for-the-network-estimation"><a class="docs-heading-anchor" href="#Getting-ready-for-the-network-estimation">Getting ready for the network estimation</a><a id="Getting-ready-for-the-network-estimation-1"></a><a class="docs-heading-anchor-permalink" href="#Getting-ready-for-the-network-estimation" title="Permalink"></a></h2><p>To start the network analysis, we need (1) starting topology, (2) sequence data and (3) an outgroup taxa.</p><p>We use the <code>PHYLIP</code> alignment file in <code>/example</code> folder of PhyNEST package. The sequence alignment is parsed using function <code>readPhyli</code> as shown <a href="https://sungsik-kong.github.io/PhyNEST.jl/dev/manual/input/#Parsing-DNA-alignment-data">here</a>. </p><p>Then, we specify the starting tree (or network) stored in the <code>HybridNetwork</code> object using function <a href="https://crsl4.github.io/PhyloNetworks.jl/latest/lib/public/#PhyloNetworks.readTopology"><code>readTopology()</code></a> from the package <code>PhyloNetworks</code>. The starting tree can be either estimated from the data or randomly generated. Here, we use an arbitrary tree topology.</p><pre><code class="language- hljs">using PhyNEST
data = readPhylipFile!(&quot;n5h1_5k.txt&quot;)
startingtree = readTopology(&quot;(5,(4,(3,(2,1))));&quot;)</code></pre><h2 id="Hill-climbing"><a class="docs-heading-anchor" href="#Hill-climbing">Hill climbing</a><a id="Hill-climbing-1"></a><a class="docs-heading-anchor-permalink" href="#Hill-climbing" title="Permalink"></a></h2><p>Network search using hill climbing algorithm is set as default</p><pre><code class="language- hljs">netHC = phyne!(startingtree,data,&quot;5&quot;)</code></pre><p>The following will be displayed <code>STDOUT</code>.</p><pre><code class="nohighlight hljs">PhyNEST: Phylogenetic Network Estimation using SiTe patterns
Analysis start: 2022-11-07 at 21:21:22
Input filename: n5h1_5k.txt
Number of sequences: 5 
Sequence length: 2500000
Starting Topology: (5,(4,(3,(2,1))));
Outgroup specified for rooting: 5
Number of maximum reticulation(s): 1
The maximum number of iterations for each optimization: 1000
Search algorithm selected: Simulated Annealing
The maximum number of steps during search: 100000
Alpha: 0.8; Cons: 0.9

Initiating 5 iterations...</code></pre><p>The analysis will create an output file named <code>PhyNEST_hc.log</code>. At each independent run, the analysis yields a single maximum composite likelihood network found.</p><pre><code class="nohighlight hljs">(1/15) Searching for the best network using the hill climbing algorithm...The search terminated at step 180 and at 100th consecutive failures.
Summary of each move:
Insertion of reticulation edge: 2 proposed, 2 accepted.
Tail move of reticulation edge: 56 proposed, 2 accepted. 
Head move of reticulation edge: 52 proposed, 0 accepted.
Change the direction of reticulation edge: 27 proposed, 1 accepted.
Deletion of reticulation edge: 0 proposed, 0 accepted.
Nearest-neighbor interchange (NNI): 43 proposed, 1 accepted.
On the current topology, 115 moves were made, including 15 unsuccessful moves.
Terminated because it reached the maximum number of failures (current maximum_number_of_failures=100).
(1/15) Estimated topology in this run: (7:5.858901865538142,(((((1:0.4895402649806814,(2:1.263190463023415)#H12:0.0::0.4954631266401886):0.7736501980427335,(3:0.4872669126554865,#H12:0.0::0.5045368733598115):0.7759235503679285):1.2442147399714147,4:2.5074052029948297):0.0,(5:0.0)#H9:0.0::0.4084401391767469):0.0,(6:0.325378144365268,#H9:0.0::0.5915598608232531):2.182027058629562):3.3514966625433122);
(1/15) Composite likelihood of the estimated topology in this run: 6.405284917395862e7</code></pre><h2 id="Simulated-annealing"><a class="docs-heading-anchor" href="#Simulated-annealing">Simulated annealing</a><a id="Simulated-annealing-1"></a><a class="docs-heading-anchor-permalink" href="#Simulated-annealing" title="Permalink"></a></h2><p>Function <code>phyne!()</code> can search the network space using simulated annealing algorithm by setting `do<em>hill</em>climbing=false&#39;.</p><pre><code class="language- hljs">netSA = phyne!(startingtree,data,&quot;5&quot;,do_hill_climbing=false)</code></pre><p><code>PhyNEST_sa.log</code> records the log throughout the searches. For each iteration (or independent run) using simulated annealing search, PhyNEST records <em>k</em> best networks searched along with other relevant information as shown below:</p><pre><code class="nohighlight hljs">(1/5) Searching for the best network using the simulated annealing algorithm...
Starting topology modified to (5,(4,(3,(2,1))));
Running 25 runs of burn-in...Complete 
(Cooling schedule)U=299136.023507182
(Cooling schedule)beta=0.8999957157391261
Rank   Composite Likelihood    Network
1	2.88360994739e6         (5:10.143244413452512,(4:5.128206352203117,((1:1.1962000978367888,(2)#H6:::0.4052526191450872):1.9174483823877784,(#H6:::0.5947473808549129,3:1.783298580712527):1.3303498995120402):2.0145578719785497):5.015038061249395);
2	2.88360994739e6         (5:10.143246111976964,(4:5.128207274589672,((3:1.7832993566222581,(2)#H6:::0.5947475713189532):1.3303497322531534,(#H6:::0.40525242868104683,1:1.1961994949262897):1.9174495939491218):2.01455818571426):5.0150388373872925);
3	2.88362151446e6         (5:10.694491971616939,(4:5.43212278921928,((3:2.485548434584157,(#H6:::0.32538307301269104,2:6.112907457836508e-13):2.4855484345835457):1.2278094075673045,(1)#H6:::0.674616926987309):1.7187649470678181):5.262369182397659);
4	2.88362151446e6         (5:10.694492301887275,(4:5.43212302522998,((3:2.485548536348796,(2:3.738582439844855e-12,(1)#H6:::0.32538305925513744):2.4855485363450573):1.2278094281091798,#H6:::0.6746169407448626):1.7187650607720037):5.262369276657295);
5	2.88362693623e6         (5:10.725629067294516,(4:5.4494219219870095,(#H6:::0.6715226076537066,(1:2.508818645237626,(2:6.922689088873185e-13,(3)#H6:::0.32847739234629336):2.508818645236934):1.2147065868268707):1.7258966899225126):5.276207145307507);
6	2.88362693623e6         (5:10.725629357953252,(4:5.449422058791485,((1:2.508818707391581,(#H6:::0.32847740524951685,2:2.954945769153218e-13):2.5088187073912858):1.2147066492672614,(3)#H6:::0.6715225947504831):1.7258967021326423):5.276207299161768);
7	2.8837567506e6         (5:12.935996175051075,(#H6:::0.21325293589105276,((1:3.1629776123192412,(2:1.933312084245944,(3)#H6:::0.7867470641089472):1.2296655280732973):3.365071192479882,4:6.528048804799123):1.170591428480983):5.237355941770969);
8	2.88378761042e6         (5:13.131954265122538,((3:3.2109280989424116,(2:1.8718749279421563,(1)#H6:::0.7233614942899573):1.3390531710002553):3.5626956885379393,(4:6.773623787480175,#H6:::0.27663850571004267):1.758593271006248e-13):6.358330477642187);
9	2.88380850997e6         (5:13.030209792938253,((1:3.198422341899994,(2:1.8541586155663632,(3)#H6:::0.7273145740149164):1.3442637263336308):3.5191039964160598,(#H6:::0.2726854259850836,4:6.717526338316051):2.6645352591003757e-15):6.312683454622199);
10	2.88380850997e6         (5:13.030209981281956,(#H6:::0.27268542338357454,(4:6.71752636287232,(1:3.198422435121352,(2:1.8541587632941887,(3)#H6:::0.7273145766164255):1.3442636718271634):3.519103927750968):0.0):6.312683618409636);
Speciation times for some newicks may not have updated if estimates are weird (e.g., NaN).
The search terminated at step 360 and at 50th consecutive failures and (Cooling schedule)ci=922.9788432411981.
Summary of each move:
Insertion of reticulation edge: 1 proposed, 1 accepted.
Tail move of reticulation edge: 99 proposed, 37 accepted. 
Head move of reticulation edge: 101 proposed, 11 accepted.
Change the direction of reticulation edge: 82 proposed, 19 accepted.
Deletion of reticulation edge: 0 proposed, 0 accepted.
Nearest-neighbor interchange (NNI): 77 proposed, 9 accepted.
On the current topology, 60 moves were made, including 10 unsuccessful moves.
Terminated because it reached the maximum number of failures (current nfail=50).
The best network found in this run: (5:10.143244413452512,(4:5.128206352203117,((1:1.1962000978367888,(2)#H6:::0.4052526191450872):1.9174483823877784,(#H6:::0.5947473808549129,3:1.783298580712527):1.3303498995120402):2.0145578719785497):5.015038061249395);
-Log Composite Likelihood: 2.8836099473859877e6</code></pre></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../input/">« Input</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.23 on <span class="colophon-date" title="Sunday 28 May 2023 23:15">Sunday 28 May 2023</span>. Using Julia version 1.9.0.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
