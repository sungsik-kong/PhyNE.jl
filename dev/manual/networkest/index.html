<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Network estimation · PhyNEST.jl</title><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.png" alt="PhyNEST.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">PhyNEST.jl</a></span></div><form class="docs-search" action="../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../">PhyNEST.jl</a></li><li><span class="tocitem">Manual</span><ul><li><a class="tocitem" href="../installation/">Installation</a></li><li><a class="tocitem" href="../input/">Input</a></li><li class="is-active"><a class="tocitem" href>Network estimation</a><ul class="internal"><li><a class="tocitem" href="#Simulated-Annealing"><span>Simulated Annealing</span></a></li><li><a class="tocitem" href="#Hill-climbing"><span>Hill climbing</span></a></li></ul></li><li><a class="tocitem" href="../quartet/">Quartet</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Manual</a></li><li class="is-active"><a href>Network estimation</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Network estimation</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/sungsik-kong/PhyNEST.jl/blob/main/docs/src/manual/networkest.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Network-estimation"><a class="docs-heading-anchor" href="#Network-estimation">Network estimation</a><a id="Network-estimation-1"></a><a class="docs-heading-anchor-permalink" href="#Network-estimation" title="Permalink"></a></h1><p>To start the network analysis, we need sequence alignment file, starting topology (that can be either randomly generated or estimated from the data using PhyNEST or other method), and an outgroup. In this example, we are going to use the Phylip alignment in the <code>/example</code> folder of PhyNEST package. First, we parse the alignment using <code>readPhylipFile!</code> function followed by reading in a random topology using <code>readTopology</code> function (see below).</p><pre><code class="language- hljs">using PhyNEST
data = readPhylipFile!(&quot;n5h1_5k.txt&quot;)
startingtree = readTopology(&quot;(5,(4,(3,(2,1))));&quot;)</code></pre><h2 id="Simulated-Annealing"><a class="docs-heading-anchor" href="#Simulated-Annealing">Simulated Annealing</a><a id="Simulated-Annealing-1"></a><a class="docs-heading-anchor-permalink" href="#Simulated-Annealing" title="Permalink"></a></h2><p>Function <code>PhyNE!()</code> executes the network analysis. By default, it uses simulated annealing alogrithm to search the network space. While there are a number of options, the search can be initiated with the starting topology and data with an outgroup specifed. Below command can be used, for example. </p><pre><code class="language- hljs">netSA = PhyNE!(startingtree,data,&quot;outgroup&quot;)</code></pre><p>To visualize the progress, an option <code>display=true</code> can be used, and the following prompt should be printed on the screen that summarizes some information of the data and the searching condition.</p><pre><code class="nohighlight hljs">PhyNE: Estimating Maximum Pseudolikelihood Phylogenetic Network
╔═══╦╗─────╔═╗─╔╗
║╔═╗║║─────║║╚╗║║
║╚═╝║╚═╦╗─╔╣╔╗╚╝╠══╗
║╔══╣╔╗║║─║║║╚╗║║║═╣
║║──║║║║╚═╝║║─║║║║═╣
╚╝──╚╝╚╩═╗╔╩╝─╚═╩══╝
───────╔═╝║ 
───────╚══╝   
Analysis start: 2022-11-02 at 17:18:20
Input filename: n5h1_5k.txt
Number of sequences: 5 
Sequence length: 2500000
Starting Topology: (5,(4,(3,(2,1))));
Outgroup specified for rooting: 5
Number of maximum reticulation(s): 1
The maximum number of iterations for each optimization: 1000
Search algorithm selected: Simulated Annealing
The maximum number of steps during search: 100000
Alpha: 0.8; Cons: 0.9</code></pre><p>Once the analysis is complete, two output files (named <code>PhyNe.sa.log</code> and <code>PhyNe.sa.out</code> by default) are stored. The <code>.log</code> file contains all output from each independent run. The <code>.out</code> file contains the network topology found with the best composite likelihood, written in formats readable in the package PhyloNetworks and Dendroscope, for visualization.</p><h2 id="Hill-climbing"><a class="docs-heading-anchor" href="#Hill-climbing">Hill climbing</a><a id="Hill-climbing-1"></a><a class="docs-heading-anchor-permalink" href="#Hill-climbing" title="Permalink"></a></h2><p>Network search using hill climbing algorithm can be initiated using an option <code>hillclimbing=true</code>.</p><pre><code class="language- hljs">netHC = PhyNE!(startingtree,data,&quot;5&quot;,hillclimbing=true)</code></pre><p>Similar to the simulation annealing, it will create two output files named <code>PhyNe.hc.log</code> and <code>PhyNe.hc.out</code></p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../input/">« Input</a><a class="docs-footer-nextpage" href="../quartet/">Quartet »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.23 on <span class="colophon-date" title="Saturday 5 November 2022 00:12">Saturday 5 November 2022</span>. Using Julia version 1.8.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
